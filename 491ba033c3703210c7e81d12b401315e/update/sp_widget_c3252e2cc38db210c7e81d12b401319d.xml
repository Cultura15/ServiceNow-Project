<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller = function($window, spUtil) {
  var c = this;

  // Default values
  c.sortOption = 'name';
  c.selectedCategory = '';
  c.searchText = '';

  // Filter logic
  c.searchFilter = function(item) {
    var matchSearch = !c.searchText || item.name.toLowerCase().includes(c.searchText.toLowerCase());
    var matchCategory = !c.selectedCategory || item.category === c.selectedCategory;
    return matchSearch && matchCategory;
  };

  // Sort handler
  c.updateSort = function() {
    c.currentSort = c.sortOption;
  };
  c.updateSort();

  // Extract unique categories
  c.getCategories = function() {
    var cats = [];
    if (!c.data.items) return cats;
    c.data.items.forEach(function(i) {
      if (i.category && cats.indexOf(i.category) === -1)
        cats.push(i.category);
    });
    return cats;
  };

  // âœ… Redirect to your PSP record producer page and prefill item name
  c.orderItem = function(item) {
    // Construct URL to your record producer
   var baseUrl = '/psmp?id=psmp_order';
	var url = baseUrl + '&item_sys_id=' + item.sys_id;

    // Redirect to the record producer
    $window.location.href = url;
  };
};
]]></client_script>
        <controller_as>c</controller_as>
        <css>/* Import Poppins Font */&#13;
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&amp;display=swap');&#13;
&#13;
.petshop-container {&#13;
  max-width: 1400px;&#13;
  margin: 0 auto;&#13;
  padding: 20px 30px;&#13;
  font-family: 'Poppins', sans-serif;&#13;
  background: linear-gradient(135deg, #f8f9ff 0%, #fff5f7 100%);&#13;
  min-height: 100vh;&#13;
}&#13;
&#13;
/* Header Section */&#13;
.header-section {&#13;
  display: flex;&#13;
  justify-content: space-between;&#13;
  align-items: center;&#13;
  margin-bottom: 30px;&#13;
  flex-wrap: wrap;&#13;
  gap: 20px;&#13;
}&#13;
&#13;
.left-controls {&#13;
  display: flex;&#13;
  gap: 12px;&#13;
  align-items: center;&#13;
  flex: 1;&#13;
  max-width: 600px;&#13;
}&#13;
&#13;
.search-wrapper {&#13;
  position: relative;&#13;
  flex: 1;&#13;
  min-width: 200px;&#13;
}&#13;
&#13;
.search-icon {&#13;
  position: absolute;&#13;
  left: 14px;&#13;
  top: 50%;&#13;
  transform: translateY(-50%);&#13;
  color: #94a3b8;&#13;
  pointer-events: none;&#13;
}&#13;
&#13;
.search-input {&#13;
  width: 100%;&#13;
  padding: 12px 16px 12px 44px;&#13;
  border: 2px solid #e2e8f0;&#13;
  border-radius: 12px;&#13;
  font-size: 14px;&#13;
  font-family: 'Poppins', sans-serif;&#13;
  font-weight: 400;&#13;
  transition: all 0.3s ease;&#13;
  background: white;&#13;
}&#13;
&#13;
.search-input:focus {&#13;
  outline: none;&#13;
  border-color: #8b5cf6;&#13;
  box-shadow: 0 0 0 4px rgba(139, 92, 246, 0.1);&#13;
}&#13;
&#13;
.search-input::placeholder {&#13;
  color: #94a3b8;&#13;
}&#13;
&#13;
.sort-dropdown {&#13;
  padding: 12px 16px;&#13;
  border: 2px solid #e2e8f0;&#13;
  border-radius: 12px;&#13;
  font-size: 14px;&#13;
  font-family: 'Poppins', sans-serif;&#13;
  font-weight: 500;&#13;
  background: white;&#13;
  cursor: pointer;&#13;
  transition: all 0.3s ease;&#13;
  min-width: 180px;&#13;
}&#13;
&#13;
.sort-dropdown:focus {&#13;
  outline: none;&#13;
  border-color: #8b5cf6;&#13;
  box-shadow: 0 0 0 4px rgba(139, 92, 246, 0.1);&#13;
}&#13;
&#13;
.shop-title {&#13;
  font-size: 32px;&#13;
  font-weight: 700;&#13;
  color: #1e293b;&#13;
  margin: 0;&#13;
  background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%);&#13;
  -webkit-background-clip: text;&#13;
  -webkit-text-fill-color: transparent;&#13;
  background-clip: text;&#13;
  letter-spacing: -0.5px;&#13;
}&#13;
&#13;
/* Category Pills */&#13;
.category-pills {&#13;
  display: flex;&#13;
  gap: 10px;&#13;
  flex-wrap: wrap;&#13;
  margin-bottom: 30px;&#13;
  padding-bottom: 20px;&#13;
  border-bottom: 2px solid #e2e8f0;&#13;
}&#13;
&#13;
.pill-btn {&#13;
  padding: 10px 20px;&#13;
  border: 2px solid #e2e8f0;&#13;
  border-radius: 25px;&#13;
  background: white;&#13;
  font-size: 14px;&#13;
  font-weight: 500;&#13;
  font-family: 'Poppins', sans-serif;&#13;
  color: #64748b;&#13;
  cursor: pointer;&#13;
  transition: all 0.3s ease;&#13;
}&#13;
&#13;
.pill-btn:hover {&#13;
  border-color: #8b5cf6;&#13;
  color: #8b5cf6;&#13;
  transform: translateY(-2px);&#13;
}&#13;
&#13;
.pill-btn.active {&#13;
  background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);&#13;
  border-color: #8b5cf6;&#13;
  color: white;&#13;
  box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);&#13;
}&#13;
&#13;
/* Items Grid */&#13;
.items-grid {&#13;
  display: grid;&#13;
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));&#13;
  gap: 24px;&#13;
  margin-bottom: 40px;&#13;
}&#13;
&#13;
.item-card {&#13;
  background: white;&#13;
  border-radius: 20px;&#13;
  overflow: hidden;&#13;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);&#13;
  transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);&#13;
  height: 100%;&#13;
  display: flex;&#13;
  flex-direction: column;&#13;
}&#13;
&#13;
.item-card:hover {&#13;
  transform: translateY(-8px);&#13;
  box-shadow: 0 20px 40px rgba(139, 92, 246, 0.2);&#13;
}&#13;
&#13;
.card-image-wrapper {&#13;
  position: relative;&#13;
  width: 100%;&#13;
  height: 240px;&#13;
  overflow: hidden;&#13;
  background: linear-gradient(135deg, #f8f9ff 0%, #fff5f7 100%);&#13;
}&#13;
&#13;
.card-image {&#13;
  width: 100%;&#13;
  height: 100%;&#13;
  object-fit: cover;&#13;
  transition: transform 0.4s ease;&#13;
}&#13;
&#13;
.item-card:hover .card-image {&#13;
  transform: scale(1.08);&#13;
}&#13;
&#13;
.stock-badge {&#13;
  position: absolute;&#13;
  top: 12px;&#13;
  right: 12px;&#13;
  background: rgba(16, 185, 129, 0.95);&#13;
  color: white;&#13;
  padding: 6px 14px;&#13;
  border-radius: 20px;&#13;
  font-size: 12px;&#13;
  font-weight: 600;&#13;
  backdrop-filter: blur(10px);&#13;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);&#13;
}&#13;
&#13;
.stock-badge.low-stock {&#13;
  background: rgba(245, 158, 11, 0.95);&#13;
}&#13;
&#13;
.stock-badge.out-of-stock {&#13;
  background: rgba(239, 68, 68, 0.95);&#13;
}&#13;
&#13;
.card-content {&#13;
  padding: 20px;&#13;
  display: flex;&#13;
  flex-direction: column;&#13;
  flex: 1;&#13;
}&#13;
&#13;
.item-name {&#13;
  font-size: 18px;&#13;
  font-weight: 600;&#13;
  color: #1e293b;&#13;
  margin: 0 0 10px 0;&#13;
  line-height: 1.4;&#13;
  display: -webkit-box;&#13;
  -webkit-line-clamp: 2;&#13;
  -webkit-box-orient: vertical;&#13;
  overflow: hidden;&#13;
}&#13;
&#13;
.item-meta {&#13;
  display: flex;&#13;
  gap: 8px;&#13;
  align-items: center;&#13;
  margin-bottom: 12px;&#13;
  flex-wrap: wrap;&#13;
}&#13;
&#13;
.category-tag {&#13;
  background: linear-gradient(135deg, #ede9fe 0%, #fce7f3 100%);&#13;
  color: #7c3aed;&#13;
  padding: 4px 12px;&#13;
  border-radius: 12px;&#13;
  font-size: 12px;&#13;
  font-weight: 600;&#13;
}&#13;
&#13;
.brand-text {&#13;
  color: #64748b;&#13;
  font-size: 13px;&#13;
  font-weight: 500;&#13;
}&#13;
&#13;
.item-description {&#13;
  font-size: 14px;&#13;
  color: #64748b;&#13;
  line-height: 1.6;&#13;
  margin-bottom: 16px;&#13;
  display: -webkit-box;&#13;
  -webkit-line-clamp: 2;&#13;
  -webkit-box-orient: vertical;&#13;
  overflow: hidden;&#13;
  flex: 1;&#13;
}&#13;
&#13;
.order-btn {&#13;
  width: 100%;&#13;
  padding: 14px 24px;&#13;
  background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);&#13;
  color: white;&#13;
  border: none;&#13;
  border-radius: 12px;&#13;
  font-size: 15px;&#13;
  font-weight: 600;&#13;
  font-family: 'Poppins', sans-serif;&#13;
  cursor: pointer;&#13;
  transition: all 0.3s ease;&#13;
  display: flex;&#13;
  align-items: center;&#13;
  justify-content: center;&#13;
  gap: 8px;&#13;
  box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);&#13;
}&#13;
&#13;
.order-btn:hover:not(:disabled) {&#13;
  background: linear-gradient(135deg, #7c3aed 0%, #6d28d9 100%);&#13;
  transform: translateY(-2px);&#13;
  box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4);&#13;
}&#13;
&#13;
.order-btn:active:not(:disabled) {&#13;
  transform: translateY(0);&#13;
}&#13;
&#13;
.order-btn:disabled {&#13;
  background: #e2e8f0;&#13;
  color: #94a3b8;&#13;
  cursor: not-allowed;&#13;
  box-shadow: none;&#13;
}&#13;
&#13;
/* Empty State */&#13;
.empty-state {&#13;
  text-align: center;&#13;
  padding: 80px 20px;&#13;
  color: #94a3b8;&#13;
}&#13;
&#13;
.empty-state svg {&#13;
  margin-bottom: 20px;&#13;
  opacity: 0.5;&#13;
}&#13;
&#13;
.empty-state h3 {&#13;
  font-size: 24px;&#13;
  font-weight: 600;&#13;
  color: #64748b;&#13;
  margin-bottom: 8px;&#13;
}&#13;
&#13;
.empty-state p {&#13;
  font-size: 16px;&#13;
  color: #94a3b8;&#13;
}&#13;
&#13;
/* Responsive Design */&#13;
@media (max-width: 768px) {&#13;
  .petshop-container {&#13;
    padding: 16px;&#13;
  }&#13;
  &#13;
  .header-section {&#13;
    flex-direction: column;&#13;
    align-items: stretch;&#13;
  }&#13;
  &#13;
  .shop-title {&#13;
    text-align: center;&#13;
    font-size: 26px;&#13;
    order: -1;&#13;
    margin-bottom: 16px;&#13;
  }&#13;
  &#13;
  .left-controls {&#13;
    flex-direction: column;&#13;
    max-width: 100%;&#13;
  }&#13;
  &#13;
  .items-grid {&#13;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));&#13;
    gap: 16px;&#13;
  }&#13;
  &#13;
  .category-pills {&#13;
    overflow-x: auto;&#13;
    flex-wrap: nowrap;&#13;
    padding-bottom: 16px;&#13;
    -webkit-overflow-scrolling: touch;&#13;
  }&#13;
  &#13;
  .pill-btn {&#13;
    white-space: nowrap;&#13;
  }&#13;
}</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>false</has_preview>
        <id/>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {
  
}]]></link>
        <name>Pet Shop Items</name>
        <option_schema/>
        <public>false</public>
        <roles>x_1607167_pet_shop.Pet Shop User</roles>
        <script><![CDATA[(function() {
    var gr = new GlideRecord('x_1607167_pet_shop_pet_shop_item');
    gr.query();

    data.items = [];
    while (gr.next()) {
        data.items.push({
            sys_id: gr.getUniqueValue(),
            name: gr.getValue('name'),
            brand: gr.getValue('brand'),
            category: gr.getValue('category'),
            short_description: gr.getValue('short_description'),
            stocks: parseInt(gr.getValue('stocks'), 10),
            image: gr.getValue('image') // attachment sys_id or ref field
        });
    }
})();
]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-11-03 11:23:02</sys_created_on>
        <sys_id>c3252e2cc38db210c7e81d12b401319d</sys_id>
        <sys_mod_count>12</sys_mod_count>
        <sys_name>Pet Shop Items</sys_name>
        <sys_package display_value="Pet Shop Needs Management" source="x_1607167_pet_shop">491ba033c3703210c7e81d12b401315e</sys_package>
        <sys_policy/>
        <sys_scope display_value="Pet Shop Needs Management">491ba033c3703210c7e81d12b401315e</sys_scope>
        <sys_update_name>sp_widget_c3252e2cc38db210c7e81d12b401319d</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-11-03 14:01:31</sys_updated_on>
        <template><![CDATA[<div class="petshop-container">
  <!-- Header Section -->
  <div class="header-section">
    <div class="left-controls">
      <div class="search-wrapper">
        <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
        <input type="text" class="search-input" placeholder="Search items..."
               ng-model="c.searchText">
      </div>
      <select class="sort-dropdown" ng-model="c.sortOption" ng-change="c.updateSort()">
        <option value="name">Sort: A-Z</option>
        <option value="-name">Sort: Z-A</option>
        <option value="category">Sort: Category</option>
        <option value="-stocks">Sort: Stock (High-Low)</option>
        <option value="stocks">Sort: Stock (Low-High)</option>
      </select>
    </div>
    <h1 class="shop-title">Pet Shop Items</h1>
  </div>

  <!-- Category Filter Pills -->
  <div class="category-pills">
    <button class="pill-btn" 
            ng-class="{'active': !c.selectedCategory}"
            ng-click="c.selectedCategory = ''">
      All Items
    </button>
    <button class="pill-btn" 
            ng-repeat="cat in c.getCategories()"
            ng-class="{'active': c.selectedCategory === cat}"
            ng-click="c.selectedCategory = cat">
      {{cat}}
    </button>
  </div>

  <!-- Items Grid -->
  <div class="items-grid">
    <div class="item-card" 
         ng-repeat="item in c.data.items | filter:c.searchFilter | orderBy:c.currentSort">
      <div class="card-image-wrapper">
        <img ng-src="/sys_attachment.do?sys_id={{item.image}}" 
             alt="{{item.name}}" 
             class="card-image"
             onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22300%22 height=%22300%22%3E%3Crect fill=%22%23f0f0f0%22 width=%22300%22 height=%22300%22/%3E%3Ctext fill=%22%23999%22 x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22 dy=%22.3em%22 font-size=%2224%22%3ENo Image%3C/text%3E%3C/svg%3E'">
        <span class="stock-badge" ng-class="{'low-stock': item.stocks < 10, 'out-of-stock': item.stocks == 0}">
          {{item.stocks > 0 ? item.stocks + ' in stock' : 'Out of stock'}}
        </span>
      </div>
      <div class="card-content">
        <h3 class="item-name">{{item.name}}</h3>
        <div class="item-meta">
          <span class="category-tag">{{item.category}}</span>
          <span class="brand-text">{{item.brand}}</span>
        </div>
        <p class="item-description">{{item.short_description}}</p>
        <button class="order-btn" 
                ng-click="c.orderItem(item)"
                ng-disabled="item.stocks == 0">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="9" cy="21" r="1"></circle>
            <circle cx="20" cy="21" r="1"></circle>
            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
          </svg>
          {{item.stocks > 0 ? 'Add to Cart' : 'Out of Stock'}}
        </button>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div class="empty-state" ng-if="(c.data.items | filter:c.searchFilter).length === 0">
    <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
      <circle cx="12" cy="12" r="10"></circle>
      <path d="M16 16s-1.5-2-4-2-4 2-4 2"></path>
      <line x1="9" y1="9" x2="9.01" y2="9"></line>
      <line x1="15" y1="9" x2="15.01" y2="9"></line>
    </svg>
    <h3>No items found</h3>
    <p>Try adjusting your search or filter</p>
  </div>
</div>]]></template>
    </sp_widget>
    <sys_es_latest_script action="INSERT_OR_UPDATE">
        <id>c3252e2cc38db210c7e81d12b401319d</id>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-11-03 11:23:01</sys_created_on>
        <sys_id>8e45ea2cc38db210c7e81d12b4013155</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-11-03 11:23:01</sys_updated_on>
        <table>sp_widget</table>
        <use_es_latest>true</use_es_latest>
    </sys_es_latest_script>
</record_update>
